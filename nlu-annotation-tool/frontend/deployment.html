<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deployment - Futuristic Interface</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="futuristic-theme.css">
    <link rel="stylesheet" href="deployment.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <span class="navbar-brand">NLU Tool - Module 4: Deployment</span>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Annotation</a></li>
                    <li class="nav-item"><a class="nav-link" href="active_learning.html">Active Learning</a></li>
                    <li class="nav-item"><a class="nav-link" href="admin_dashboard.html">Admin Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link" href="auth.html">Logout</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-5">
        <div class="row">
            <div class="col-md-12">
                <h2>Deployment Pipeline</h2>
                <p class="text-muted">Manage and deploy your trained models to production environments.</p>
            </div>
        </div>

        <!-- Deployment Status -->
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Current Deployment Status</h5>
                    </div>
                    <div class="card-body" id="deployment-status-container">
                        Loading deployment status...
                    </div>
                </div>
            </div>
        </div>

        <!-- Pipeline Steps -->
        <div class="row mt-4">
            <div class="col-md-12">
                <h4 class="mb-3">Deployment Pipeline</h4>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="card deployment-card">
                    <div class="card-body text-center">
                        <div class="pipeline-icon">
                            <i class="fas fa-cube"></i>
                        </div>
                        <h5 class="card-title">1. Build Docker Image</h5>
                        <p class="card-text text-muted">Create a Docker image with the trained models</p>
                        <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#buildModal">
                            Build Image
                        </button>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card deployment-card">
                    <div class="card-body text-center">
                        <div class="pipeline-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h5 class="card-title">2. Push to Registry</h5>
                        <p class="card-text text-muted">Push the built image to a container registry</p>
                        <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#pushModal">
                            Push Image
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card deployment-card">
                    <div class="card-body text-center">
                        <div class="pipeline-icon">
                            <i class="fas fa-rocket"></i>
                        </div>
                        <h5 class="card-title">3. Deploy to Production</h5>
                        <p class="card-text text-muted">Deploy the image to your production cluster</p>
                        <button class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#deployModal">
                            Deploy
                        </button>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card deployment-card">
                    <div class="card-body text-center">
                        <div class="pipeline-icon">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <h5 class="card-title">4. Health Check</h5>
                        <p class="card-text text-muted">Monitor deployment health and logs</p>
                        <button class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#healthModal">
                            Check Status
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Deployment History -->
        <div class="row mt-5">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Deployment History</h5>
                    </div>
                    <div class="card-body" id="deployment-history-container">
                        <p class="text-muted">No deployments yet</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="row mt-4 mb-5">
            <div class="col-md-12">
                <a href="admin_dashboard.html" class="btn btn-secondary">Back to Admin Dashboard</a>
            </div>
        </div>
    </div>

    <!-- Build Modal -->
    <div class="modal fade" id="buildModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Build Docker Image</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>This feature will:</p>
                    <ul>
                        <li>Package your latest trained models</li>
                        <li>Create a Docker image with runtime dependencies</li>
                        <li>Tag the image with a version number</li>
                    </ul>
                    <div class="mb-3">
                        <label class="form-label">Image Name:</label>
                        <input type="text" id="docker-image-name" class="form-control" value="nlu-tool" placeholder="nlu-tool">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Tag:</label>
                        <input type="text" id="docker-image-tag" class="form-control" value="latest" placeholder="latest">
                    </div>
                    <div id="build-output" class="alert alert-info d-none">
                        <strong>Build Output:</strong>
                        <pre id="build-output-text" class="mt-2 mb-0" style="max-height: 200px; overflow-y: auto; font-size: 0.85rem;"></pre>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" id="build-docker-btn" class="btn btn-primary" onclick="buildDockerImage()">
                        Build Docker Image
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Push Modal -->
    <div class="modal fade" id="pushModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Push to Container Registry</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Push your Docker image to DockerHub:</p>
                    <div class="mb-3">
                        <label class="form-label">Local Image Name:</label>
                        <input type="text" id="push-image-name" class="form-control" value="nlu-tool:latest" placeholder="nlu-tool:latest">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Registry Username (DockerHub):</label>
                        <input type="text" id="push-registry-username" class="form-control" placeholder="your-dockerhub-username">
                        <small class="text-muted">Your DockerHub username</small>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Repository Name:</label>
                        <input type="text" id="push-repo-name" class="form-control" value="nlu-tool" placeholder="nlu-tool">
                    </div>
                    <div id="push-output" class="alert alert-info d-none">
                        <strong>Push Output:</strong>
                        <pre id="push-output-text" class="mt-2 mb-0" style="max-height: 200px; overflow-y: auto; font-size: 0.85rem;"></pre>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" id="push-image-btn" class="btn btn-primary" onclick="pushDockerImage()">
                        Push to DockerHub
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Deploy Modal -->
    <div class="modal fade" id="deployModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Deploy to Production</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Deploy container locally using Docker:</p>
                    <div class="mb-3">
                        <label class="form-label">Image to Deploy:</label>
                        <input type="text" id="deploy-image-name" class="form-control" value="nlu-tool:latest" placeholder="nlu-tool:latest">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Container Name:</label>
                        <input type="text" id="deploy-container-name" class="form-control" value="nlu-tool-container" placeholder="nlu-tool-container">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Port Mapping:</label>
                        <input type="text" id="deploy-port" class="form-control" value="8080:5000" placeholder="8080:5000">
                        <small class="text-muted">Format: host:container (e.g., 8080:5000)</small>
                    </div>
                    <div id="deploy-output" class="alert alert-info d-none">
                        <strong>Deployment Output:</strong>
                        <pre id="deploy-output-text" class="mt-2 mb-0" style="max-height: 200px; overflow-y: auto; font-size: 0.85rem;"></pre>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" id="deploy-btn" class="btn btn-success" onclick="deployContainer()">
                        Deploy Container
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Health Modal -->
    <div class="modal fade" id="healthModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Deployment Health Status</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="health-details">
                    <p class="text-muted">Loading health status...</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="refreshHealthStatus()">Refresh</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="deployment.js"></script>
</body>
</html>
